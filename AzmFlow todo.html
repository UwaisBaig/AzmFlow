{% extends "layout.html" %} {% block content %}
<div class="container mt-5">
  <h2 class="mb-4">To-Do List</h2>

  <!-- Progress Bar -->
  <div class="mb-4">
    <h5>Progress</h5>
    {% if todos %}
    <div class="progress mb-3" style="height: 25px">
      <div
        class="progress-bar bg-success progress-bar-striped progress-bar-animated"
        role="progressbar"
        style="width: {{ progress }}%;"
        aria-valuenow="{{ progress }}"
        aria-valuemin="0"
        aria-valuemax="100"
      >
        {{ progress }}% Completed
      </div>
    </div>
    {% endif %}
  </div>

  <!-- Add Task Form -->
  <form action="/todo" method="POST" class="d-flex mb-3">
    <input
      type="text"
      name="task"
      placeholder="Enter task..."
      class="form-control me-2"
      required
    />
    <button type="submit" class="btn btn-primary">Add</button>
  </form>

  <!-- Tasks List -->
  <ul class="list-group">
    {% for t in todos %}
    <li
      class="list-group-item d-flex justify-content-between align-items-center {% if t.completed %}list-group-item-success{% endif %}"
    >
      <span>
        {% if t.completed %} ‚úÖ <del>{{ t.task }}</del>
        {% else %} üìù {{ t.task }} {% endif %}
      </span>
      <div>
        {% if not t.completed %}
        <!-- Complete button -->
        <form
          method="POST"
          action="{{ url_for('complete_task', task_id=t.id) }}"
          class="d-inline"
        >
          <button type="submit" class="btn btn-sm btn-success">Complete</button>
        </form>
        {% else %}
        <!-- Undo button -->
        <form
          method="POST"
          action="{{ url_for('undo_task', task_id=t.id) }}"
          class="d-inline"
        >
          <button type="submit" class="btn btn-sm btn-warning">Undo</button>
        </form>
        {% endif %}

        <!-- Delete button -->
        <form
          method="POST"
          action="{{ url_for('delete_task', task_id=t.id) }}"
          class="d-inline"
        >
          <button type="submit" class="btn btn-sm btn-danger">Delete</button>
        </form>
      </div>
    </li>
    {% else %}
    <li class="list-group-item text-center"><em>No tasks yet!</em></li>
    {% endfor %}
  </ul>
</div>
{% endblock %}
